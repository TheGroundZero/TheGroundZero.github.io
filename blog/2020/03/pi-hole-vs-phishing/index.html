<!doctype html><html lang=en><head><meta charset=UTF-8><meta http-equiv=X-UA-Compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=author content="DezeStijn"><meta name=description content="The Pi-hole is a powerful tool against tracking but can be used to protect against phishing as well."><meta name=keywords content="Sequr,blog,writeup,CTF,challenge,machine,infosec,IT security,hacking,pentesting,cybersecurity,Pi-hole,PiHole,spam,tracking,advertisements,ads,phishing"><meta name=robots content="noodp"><meta name=theme-color content="#252627"><link rel=canonical href=https://sequr.be/blog/2020/03/pi-hole-vs-phishing/><title>Pi-hole vs Phishing :: Sequr</title><link rel=stylesheet href=https://sequr.be/main.min.244183cde1a38e0b08f82c11791181288f9aac1cc9618cd6f4e9e7710c5768ba.css integrity="sha256-JEGDzeGjjgsI+CwReRGBKI+arBzJYYzW9OnncQxXaLo=" crossorigin=anonymous><link rel=stylesheet type=text/css href=https://sequr.be/css/table.css><link rel=stylesheet type=text/css href=https://sequr.be/css/menu.css><link rel=apple-touch-icon sizes=180x180 href=https://sequr.be/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://sequr.be/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://sequr.be/favicon-16x16.png><link rel=manifest href=https://sequr.be/site.webmanifest><link rel=mask-icon href=https://sequr.be/safari-pinned-tab.svg color><link rel="shortcut icon" href=https://sequr.be/favicon.ico><meta name=msapplication-TileColor content><meta itemprop=name content="Pi-hole vs Phishing"><meta itemprop=description content="The Pi-hole is a powerful tool against tracking but can be used to protect against phishing as well."><meta itemprop=datePublished content="2020-03-20T00:00:00+00:00"><meta itemprop=dateModified content="2023-01-30T00:00:00+00:00"><meta itemprop=wordCount content="765"><meta itemprop=image content="https://sequr.be/blog/2020/03/pi-hole-vs-phishing/cover.jpg"><meta itemprop=keywords content="Pi-Hole,PiHole,Spam,Tracking,Advertisements,Ads,Phishing"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://sequr.be/blog/2020/03/pi-hole-vs-phishing/cover.jpg"><meta name=twitter:title content="Pi-hole vs Phishing"><meta name=twitter:description content="The Pi-hole is a powerful tool against tracking but can be used to protect against phishing as well."><meta property="article:section" content="Cybersecurity"><meta property="article:published_time" content="2020-03-20 00:00:00 +0000 UTC"></head><body><div class=container><header class=header><span class=header__inner><a href=https://sequr.be/ style=text-decoration:none><div class=logo><span class=logo__mark>$</span>
<span class=logo__text>lynx sequr.be</span>
<span class=logo__cursor style=background-color:#e68101></span></div></a><span class=header__right><nav class=menu><ul class=menu__inner><li><a href=https://sequr.be/about/>About</a></li><li><a href=https://sequr.be/blog/>Blog</a></li><li><a href=https://sequr.be/privacy/>Privacy</a></li><li><a href=https://sequr.be/shoppinglist/>Shopping</a></li></ul></nav><span class=menu-trigger><svg viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg>
</span><span class="theme-toggle not-selectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none"><path d="M22 41c10.4934.0 19-8.5066 19-19C41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg></span></span></span></header><div class=content><main class="post h-entry"><div class=post-info><p><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
4 minutes</p></div><article><h1 class="post-title p-name"><a href=https://sequr.be/blog/2020/03/pi-hole-vs-phishing/ class=u-url>Pi-hole vs Phishing</a></h1><div class="post-content e-content"><h2 id=pi-hole>Pi-Hole <a href=#pi-hole>¶</a></h2><p>If you&rsquo;ve ever done some research on protecting yourself against online tracking, you&rsquo;ve definitely seen articles discussing <a href=https://pi-hole.net title="Pi-hole - Network-wide Ad Blocking" target=_blank rel=noopener>Pi-hole</a>, a network-wide ad blocking service/tool.</p><p>You can install Pi-hole on just about any hardware (including a <a href=https://www.raspberrypi.org title="Raspberry Pi" target=_blank rel=noopener>Raspberry Pi</a>) or as a VM. I switched from a Raspberry Pi to a Linux Containers (LXC) on <a href=https://www.proxmox.com title="Proxmox - powerful open-source server solutions" target=_blank rel=noopener>Proxmox</a>.<br>After you installed your Pi-hole instance, you configure the devices on your home network to use it as their primary DNS server.
In a more advanced network, you can use DHCP leases or an Active Directory environment to automatically configure your clients.
This is especially usefull when you can&rsquo;t manually configure DNS on your clients (e.g. IoT or roaming devices).
If you can&rsquo;t configure DHCP leases (e.g. ISP-provided modem/router combo), you can configure your Pi-hole instance to also act as a DHCP server, handing out IP addresses and configuring DNS.<br>This wide variety of configurations and features makes Pi-hole an incredibly powerfull asset in protecting your online activity against unwanted tracking.</p><p>The actual installation of Pi-hole is outside the scope of this blog post, mainly because there are hundreds if not thousands of tutorials available online.
I advise you to start with the <a href=https://docs.pi-hole.net title="Pi-hole documentation" target=_blank rel=noopener>official documentation</a>.</p><h2 id=blocklists>Blocklists <a href=#blocklists>¶</a></h2><p>You can configure your Pi-hole instance to one or more &ldquo;safe&rdquo; upstream DNS providers, like OpenDNS and Quad9, which provide some protection against unwanted websites as they provide some DNS filtering.<br>Some upstream providers are also configured to use DNSSEC, which will allow the Pi-hole to validate the signature of DNS responses, protecting against DNS response modifications.</p><p>One of the main features of Pi-hole, however, is its blocklists.
These blocklists are consolidated by Gravity, an internal Pi-hole script, into a one unique list used by the DNS resolver to block or whitelist DNS queries.</p><p>Pi-hole by default includes some lists that will block domains linked to tracking by advertisement companies.
As such, your online browsing is already much &ldquo;cleaner&rdquo; as soon as your clients use Pi-hole for their DNS queries.</p><h2 id=pi-hole-vs-phishing>Pi-hole vs Phishing <a href=#pi-hole-vs-phishing>¶</a></h2><p>Now we come to the crux of this blog post: weaponising your Pi-hole instance to help protect you against phishing.</p><p>Phishing attacks often include the use of malicious domains hosting copies of legitimate websites.
These domains eventually get picked up by antimalware and/or threat intel companies, who often also compile lists of &ldquo;bad domains&rdquo;.</p><p>We can use these lists to help protect users on our network against phishing.<br>Note that this won&rsquo;t protect you against phishing sites hosted on legitimate domains (e.g. sharepoint) or which haven&rsquo;t been flagged yet.</p><p><a href=https://www.phishing.army title="Phishing Army" target=_blank rel=noopener>Phishing Army</a> is one of the organisations compiling lists of phishing related domains.
Their list, which is updated every six hours, includes reports from <a href=https://www.phishtank.com title=PhishTank target=_blank rel=noopener>PhishTank</a>, <a href=https://openphish.com title=OpenPhish target=_blank rel=noopener>OpenPhish</a> and <a href=https://github.com/mitchellkrogza/Phishing.Database title="PhishFindR / Phishing.Database" target=_blank rel=noopener>PhishFindR</a>.</p><p>Adding this list to Pi-hole is very easy.</p><p>Login on the Pi-Hole admin portal.
You can find it at <code>http://&lt;pi-hole IP>/admin</code></p><figure class=center><img src=login.png alt="Pi-hole login"><figcaption class=center>Pi-hole admin login</figcaption></figure><p>Go to Settings, then Blocklists and add the Phishing Army blocklist URL to the list.</p><p><code>https://phishing.army/download/phishing_army_blocklist.txt</code></p><blockquote><p><strong>Update 2020-07-20</strong><br>Another useful blocklist is that of <a href=https://urlhaus.abuse.ch/ title="URLhaus by Abuse.ch" target=_blank rel=noopener>URLhaus by Abuse.ch</a></p><p><code>https://urlhaus.abuse.ch/downloads/hostfile/</code></p></blockquote><figure class=center><img src=add-blocklist.png alt="Adding the blocklist to Pi-hole"><figcaption class=center>Adding the blocklist to Pi-hole</figcaption></figure><blockquote><p><strong>Update 2020-07-20</strong><br>Clients can now be grouped and adlists can be assigned to those groups.<br>Because of this change, adlists have been moved and can now be found under &ldquo;Group Management&rdquo;.</p></blockquote><p>Click &ldquo;Save and Update&rdquo; to immediately update Gravity, or click &ldquo;Save&rdquo; and manually update Gravity (Tools > Update Gravity).</p><figure class=center><img src=update-gravity.png alt="Updating Gravity"><figcaption class=center>Updating Gravity</figcaption></figure><p>You can check whether the blocklist is functioning correctly by testing a domain you know is present in the blocklist.</p><figure class=center><img src=query.png alt="Blocklist query"><figcaption class=center>Testing the blocklist</figcaption></figure><p>Browsing to this domain, you&rsquo;ll see your system won&rsquo;t be able to find it.
The Pi-hole query log show that the query was blocked via the internal block list (blocked - gravity).
In my case, the domain lookup was also blocked by the upstream DNS provider (blocked - external).</p><figure class=center><img src=log.png alt="Query log"><figcaption class=center>Query log</figcaption></figure><p>Note that Pi-hole automatically updates Gravity every Sunday.
If you want to update more frequently, SSH into your Pi-hole and modify <code>/etc/cron.d/pihole</code>.</p><figure class=center><img src=cron.png alt="Pi-hole crontab"><figcaption class=center>Pi-hole crontab</figcaption></figure><h2 id=upstream-dns>Upstream DNS <a href=#upstream-dns>¶</a></h2><p>Another important improvement you can make, is picking a secure and privacy-preserving upstream DNS.
This ensures the DNS queries that weren&rsquo;t blocked by PiHole aren&rsquo;t logged by e.g. your ISP and some upstream DNS providers add the option of using their blocklists as well.</p><p>I personally can recomment <a href="https://nextdns.io/?from=dctv58ke" title="NextDNS - The new firewall for the modern Internet" target=_blank rel=noopener>NextDNS</a> as upstream DNS provider.
Not only do they have additional lists like Threat Intelligence Feeds and Cryptojacking prevention, they also allow you to block newly registred domains (common in phishing) and help protect against DNS rebinding attacks.
Their free plan grants you 300,000 queries per month and upgrading to unlimited costs you less than €20 per year.</p></div></article><hr><div class=post-info><p><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7" y2="7"/></svg>
<span class=tag><a href=https://sequr.be/tags/pi-hole/>Pi-hole</a></span>
<span class=tag><a href=https://sequr.be/tags/pihole/>PiHole</a></span>
<span class=tag><a href=https://sequr.be/tags/spam/>spam</a></span>
<span class=tag><a href=https://sequr.be/tags/tracking/>tracking</a></span>
<span class=tag><a href=https://sequr.be/tags/advertisements/>advertisements</a></span>
<span class=tag><a href=https://sequr.be/tags/ads/>ads</a></span>
<span class=tag><a href=https://sequr.be/tags/phishing/>phishing</a></span></p><p><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-folder meta-icon"><path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5a2 2 0 012-2h5l2 3h9a2 2 0 012 2z"/></svg>
<span class=tag><a class=p-category href=https://sequr.be/categories/cybersecurity/>Cybersecurity</a></span></p><p><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6A2 2 0 004 4v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>
765 Words</p><p><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
<time class=dt-published datetime=2020-03-20T00:00:00+00:00>2020-03-20
</time>(Last updated: <time class=dt-updated datetime=2023-01-30T00:00:00+00:00>2023-01-30</time>)</p><p><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-user"><path d="M20 21v-2a4 4 0 00-4-4H8a4 4 0 00-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
<span rel=author class="p-author h-card">DezeStijn</span></p></div><hr><div class=sharing-buttons><a class=resp-sharing-button__link href=https://ko-fi.com/s4squatch target=_blank rel=noopener aria-label title="Buy me a coffee"><div class="resp-sharing-button resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentcolor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"><path d="M23.881 8.948c-.773-4.085-4.859-4.593-4.859-4.593H.723c-.604.0-.679.798-.679.798s-.082 7.324-.022 11.822c.164 2.424 2.586 2.672 2.586 2.672s8.267-.023 11.966-.049c2.438-.426 2.683-2.566 2.658-3.734 4.352.24 7.422-2.831 6.649-6.916zm-11.062 3.511c-1.246 1.453-4.011 3.976-4.011 3.976s-.121.119-.31.023c-.076-.057-.108-.09-.108-.09-.443-.441-3.368-3.049-4.034-3.954-.709-.965-1.041-2.7-.091-3.71.951-1.01 3.005-1.086 4.363.407.0.0 1.565-1.782 3.468-.963 1.904.82 1.832 3.011.723 4.311zm6.173.478c-.928.116-1.682.028-1.682.028V7.284h1.77s1.971.551 1.971 2.638c0 1.913-.985 2.667-2.059 3.015z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fsequr.be%2fblog%2f2020%2f03%2fpi-hole-vs-phishing%2f" target=_blank rel=noopener aria-label title="Share on facebook"><div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 2h-3a5 5 0 00-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 011-1h3z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://twitter.com/intent/tweet/?url=https%3a%2f%2fsequr.be%2fblog%2f2020%2f03%2fpi-hole-vs-phishing%2f" target=_blank rel=noopener aria-label title="Share on twitter"><div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://reddit.com/submit/?url=https%3a%2f%2fsequr.be%2fblog%2f2020%2f03%2fpi-hole-vs-phishing%2f&amp;resubmit=true&amp;title=Pi-hole%20vs%20Phishing" target=_blank rel=noopener aria-label title="Share on reddit"><div class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentcolor" stroke="none"><path d="M12 0A12 12 0 000 12a12 12 0 0012 12 12 12 0 0012-12A12 12 0 0012 0zm5.01 4.744c.688.0 1.25.561 1.25 1.249a1.25 1.25.0 01-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968.0 1.754.786 1.754 1.754.0.716-.435 1.333-1.01 1.614a3.111 3.111.0 01.042.52c0 2.694-3.13 4.87-7.004 4.87s-7.004-2.176-7.004-4.87c0-.183.015-.366.043-.534A1.748 1.748.0 014.028 12c0-.968.786-1.754 1.754-1.754.463.0.898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342.0 01.14-.197.35.35.0 01.238-.042l2.906.617a1.214 1.214.0 011.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687.0 1.248-.561 1.248-1.249S9.937 12 9.249 12zm5.5.0c-.687.0-1.248.561-1.248 1.25.0.687.561 1.248 1.249 1.248S16 13.937 16 13.249c0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327.0 00-.231.094.33.33.0 000 .463c.842.842 2.484.913 2.961.913s2.105-.056 2.961-.913a.361.361.0 00.029-.463.33.33.0 00-.464.0c-.547.533-1.684.73-2.512.73-.828.0-1.979-.196-2.512-.73a.326.326.0 00-.232-.095z"/></svg></div></div></a><a class=resp-sharing-button__link href="mailto:?subject=Pi-hole%20vs%20Phishing&amp;body=https%3a%2f%2fsequr.be%2fblog%2f2020%2f03%2fpi-hole-vs-phishing%2f" target=_self rel=noopener aria-label title="Share via email"><div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg></div></div></a></div><div class=pagination><div class=pagination__buttons><span class="button previous"><a href=https://sequr.be/blog/2020/03/easy-phish/><span class=button__icon>←</span>
<span class=button__text>Easy Phish</span>
</a></span><span class="button next"><a href=https://sequr.be/blog/2020/03/traceback/><span class=button__text>Traceback</span>
<span class=button__icon>→</span></a></span></div></div></main></div><footer class=footer><div class=footer__inner><div class=footer__content><span>&copy; 2019</span>
<span><a class=h-card rel=me href=https://sequr.be/>DezeStijn</a></span>
<span><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/ target=_blank rel=noopener>CC BY-NC-SA 4.0</a></span>
<span><a href=https://sequr.be/posts/index.xml target=_blank title=rss><svg width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></span></div></div></footer></div><script type=text/javascript src=https://sequr.be/bundle.min.e89fda0f29b95d33f6f4224dd9e5cf69d84aff3818be2b0d73e731689cc374261b016d17d46f8381962fb4a1577ba3017b1f23509d894f6e66431f988c00889e.js integrity="sha512-6J/aDym5XTP29CJN2eXPadhK/zgYvisNc+cxaJzDdCYbAW0X1G+DgZYvtKFXe6MBex8jUJ2JT25mQx+YjACIng=="></script></body></html>