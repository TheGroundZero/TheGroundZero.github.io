<!doctype html><html lang=en><head><meta charset=UTF-8><meta http-equiv=X-UA-Compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=author content="DezeStijn"><meta name=description content="Write-up of level 10 to 20 of the Bandit challenge on OverTheWire.org"><meta name=keywords content="Sequr,blog,writeup,CTF,challenge,machine,infosec,IT security,hacking,pentesting,cybersecurity,Bandit,Over The Wire,OverTheWire"><meta name=robots content="noodp"><meta name=theme-color content="#252627"><link rel=canonical href=https://sequr.be/blog/2020/01/bandit-10-20/><title>Bandit (10 -> 20) :: Sequr
</title><link rel=stylesheet href=https://sequr.be/main.min.244183cde1a38e0b08f82c11791181288f9aac1cc9618cd6f4e9e7710c5768ba.css integrity="sha256-JEGDzeGjjgsI+CwReRGBKI+arBzJYYzW9OnncQxXaLo=" crossorigin=anonymous><link rel=stylesheet type=text/css href=https://sequr.be/css/table.css><link rel=stylesheet type=text/css href=https://sequr.be/css/menu.css><link rel=apple-touch-icon sizes=180x180 href=https://sequr.be/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://sequr.be/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://sequr.be/favicon-16x16.png><link rel=manifest href=https://sequr.be/site.webmanifest><link rel=mask-icon href=https://sequr.be/safari-pinned-tab.svg color><link rel="shortcut icon" href=https://sequr.be/favicon.ico><meta name=msapplication-TileColor content><meta itemprop=name content="Bandit (10 -> 20)"><meta itemprop=description content="Write-up of level 10 to 20 of the Bandit challenge on OverTheWire.org"><meta itemprop=datePublished content="2020-01-09T11:12:17+00:00"><meta itemprop=dateModified content="2020-01-09T11:12:17+00:00"><meta itemprop=wordCount content="1317"><meta itemprop=image content="https://sequr.be/blog/2020/01/bandit-10-20/otw-bandit.png"><meta itemprop=keywords content="Bandit,Over the Wire,OverTheWire"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://sequr.be/blog/2020/01/bandit-10-20/otw-bandit.png"><meta name=twitter:title content="Bandit (10 -> 20)"><meta name=twitter:description content="Write-up of level 10 to 20 of the Bandit challenge on OverTheWire.org"><meta property="article:section" content="OverTheWire"><meta property="article:section" content="Writeup"><meta property="article:published_time" content="2020-01-09 11:12:17 +0000 UTC"><link rel=webmention href=https://webmention.io/sequr.be/webmention></head><body><div class=container><header class=header><span class=header__inner><a href=https://sequr.be/ style=text-decoration:none><div class=logo><span class=logo__mark>$</span>
<span class=logo__text>lynx sequr.be</span>
<span class=logo__cursor style=background-color:#e68101></span></div></a><span class=header__right><nav class=menu><ul class=menu__inner><li><a href=https://sequr.be/about/>About</a></li><li><a href=https://sequr.be/blog/>Blog</a></li><li><a href=https://sequr.be/privacy/>Privacy</a></li><li><a href=https://sequr.be/shoppinglist/>Shopping</a></li></ul></nav><span class=menu-trigger><svg viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg>
</span><span class="theme-toggle not-selectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none"><path d="M22 41c10.4934.0 19-8.5066 19-19C41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg></span></span></span></header><div class=content><main class="post h-entry"><div class=post-info><p><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
7 minutes</p></div><article><h1 class="post-title p-name"><a href=https://sequr.be/blog/2020/01/bandit-10-20/ class=u-url>Bandit (10 -> 20)</a></h1><div class="post-content e-content"><h2 id=info>Info <a href=#info>¶</a></h2><p>From the <a href=https://overthewire.org/wargames/ target=_blank rel=noopener>OverTheWire website</a>:</p><blockquote><p>The wargames offered by the OverTheWire community can help you to learn and practice security concepts in the form of fun-filled games.</p><p>~ OverTheWire.org</p></blockquote><h2 id=bandit>Bandit <a href=#bandit>¶</a></h2><p>Bandit is the first series of challenges and it&rsquo;s recommended to start with these.</p><blockquote><p>The Bandit wargame is aimed at absolute beginners. It will teach the basics needed to be able to play other wargames.</p><p>~ OverTheWire.org</p></blockquote><p>Make sure you following along on the website to get more info on the goal of the challenges and the skills that you&rsquo;ll learn from them.</p><p>Always first try to do a challenge yourself.<br>You&rsquo;ll learn more and might find methodologies or techniques that work better for you.</p><p>This write-up contains the solution of levels 10 to 20.<br>Need to go back for <a href=https://sequr.be/blog/2020/01/bandit-0-10/>levels 0 to 10</a>?</p><h3 id=level-10---11>Level 10 -> 11 <a href=#level-10---11>¶</a></h3><p>Connect with the OverTheWire infrastructure using the credentials retrieved in the previous level.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>$ ssh bandit10@bandit.labs.overthewire.org -p <span style=color:#ae81ff>2220</span>                
</span></span><span style=display:flex><span>This is a OverTheWire game server. More information on http://www.overthewire.org/wargames
</span></span><span style=display:flex><span>                          
</span></span><span style=display:flex><span>bandit10@bandit.labs.overthewire.org<span style=color:#960050;background-color:#1e0010>&#39;</span>s password:
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>bandit10@bandit:~$ base64 -d data.txt 
</span></span><span style=display:flex><span>The password is IF##########PR
</span></span></code></pre></div><h3 id=level-11---level-12>Level 11 -> Level 12 <a href=#level-11---level-12>¶</a></h3><p>This is basically ROT13. So to &ldquo;reverse&rdquo; this, we need to apply another round of ROT13 to the data.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>bandit11@bandit:~$ cat data.txt | tr <span style=color:#e6db74>&#39;a-zA-Z&#39;</span> <span style=color:#e6db74>&#39;n-za-mN-ZA-N&#39;</span>
</span></span><span style=display:flex><span>The password is 5T##########Uu
</span></span></code></pre></div><h3 id=level-12---level-13>Level 12 -> Level 13 <a href=#level-12---level-13>¶</a></h3><p>As suggested by the level description, we first copy the data.txt file to a folder in <code>/tmp/</code> where we can create and move files.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>bandit12@bandit:~$ mkdir /tmp/sequr
</span></span><span style=display:flex><span>bandit12@bandit:~$ cd /tmp/sequr
</span></span><span style=display:flex><span>bandit12@bandit:/tmp/sequr$ cp ~/data.txt .
</span></span></code></pre></div><p><code>data.txt</code> contains a hexdump, which we can easily confirm.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>bandit12@bandit:/tmp/sequr$ head data.txt 
</span></span><span style=display:flex><span>00000000: 1f8b <span style=color:#ae81ff>0808</span> d7d2 c55b <span style=color:#ae81ff>0203</span> <span style=color:#ae81ff>6461</span> <span style=color:#ae81ff>7461</span> 322e  .......<span style=color:#f92672>[</span>..data2.
</span></span><span style=display:flex><span>00000010: <span style=color:#ae81ff>6269</span> 6e00 013c 02c3 fd42 5a68 <span style=color:#ae81ff>3931</span> <span style=color:#ae81ff>4159</span>  bin..&lt;...BZh91AY
</span></span><span style=display:flex><span>00000020: <span style=color:#ae81ff>2653</span> 591d aae5 <span style=color:#ae81ff>9800</span> 001b ffff de7f 7fff  &amp;SY.............
</span></span></code></pre></div><p>Reverse the hexdump, which gives us a gzip compressed container.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>bandit12@bandit:/tmp/sequr$ xxd -r data.txt &gt; data-dedumped
</span></span><span style=display:flex><span>bandit12@bandit:/tmp/sequr$ file data-dedumped 
</span></span><span style=display:flex><span>data-dedumped: gzip compressed data, was <span style=color:#e6db74>&#34;data2.bin&#34;</span>, last modified: Tue Oct <span style=color:#ae81ff>16</span> 12:00:23 2018, max compres
</span></span><span style=display:flex><span>sion, from Unix
</span></span></code></pre></div><p>Decompress to get a bzip2 compressed container.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>bandit12@bandit:/tmp/sequr$ mv data-dedumped data.gz
</span></span><span style=display:flex><span>bandit12@bandit:/tmp/sequr$ gunzip data.gz
</span></span><span style=display:flex><span>bandit12@bandit:/tmp/sequr$ file data
</span></span><span style=display:flex><span>data: bzip2 compressed data, block size <span style=color:#f92672>=</span> 900k
</span></span></code></pre></div><p>Decompress again (gzip).</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>bandit12@bandit:/tmp/sequr$ bzip2 -d data
</span></span><span style=display:flex><span>bzip2: Can<span style=color:#960050;background-color:#1e0010>&#39;</span>t guess original name <span style=color:#66d9ef>for</span> data -- using data.out
</span></span><span style=display:flex><span>bandit12@bandit:/tmp/sequr$ file data.out 
</span></span><span style=display:flex><span>data.out: gzip compressed data, was <span style=color:#e6db74>&#34;data4.bin&#34;</span>, last modified: Tue Oct <span style=color:#ae81ff>16</span> 12:00:23 2018, max compression, from Unix
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>bandit12@bandit:/tmp/sequr$ mv data.out data.gz
</span></span><span style=display:flex><span>bandit12@bandit:/tmp/sequr$ gunzip data.gz
</span></span><span style=display:flex><span>bandit12@bandit:/tmp/sequr$ file data
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>bandit12@bandit:/tmp/sequr$ mv data data.tar
</span></span><span style=display:flex><span>bandit12@bandit:/tmp/sequr$ tar -xf data.tar
</span></span><span style=display:flex><span>bandit12@bandit:/tmp/sequr$ file data5.bin 
</span></span><span style=display:flex><span>data5.bin: POSIX tar archive <span style=color:#f92672>(</span>GNU<span style=color:#f92672>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>bandit12@bandit:/tmp/sequr$ tar -xf data5.bin
</span></span><span style=display:flex><span>bandit12@bandit:/tmp/sequr$ file data6.bin 
</span></span><span style=display:flex><span>data6.bin: bzip2 compressed data, block size <span style=color:#f92672>=</span> 900k
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>bandit12@bandit:/tmp/sequr$ bzip2 -d data6.bin
</span></span><span style=display:flex><span>bzip2: Can<span style=color:#960050;background-color:#1e0010>&#39;</span>t guess original name <span style=color:#66d9ef>for</span> data6.bin -- using data6.bin.out
</span></span><span style=display:flex><span>bandit12@bandit:/tmp/sequr$ file data6.bin.out 
</span></span><span style=display:flex><span>data6.bin.out: POSIX tar archive <span style=color:#f92672>(</span>GNU<span style=color:#f92672>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>bandit12@bandit:/tmp/sequr$ tar -xf data6.bin.out
</span></span><span style=display:flex><span>bandit12@bandit:/tmp/sequr$ file data8.bin 
</span></span><span style=display:flex><span>data8.bin: gzip compressed data, was <span style=color:#e6db74>&#34;data9.bin&#34;</span>, last modified: Tue Oct <span style=color:#ae81ff>16</span> 12:00:23 2018, max compression, from Unix
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>bandit12@bandit:/tmp/sequr$ mv data8.<span style=color:#f92672>{</span>bin,gz<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>bandit12@bandit:/tmp/sequr$ gzip -d data8.gz
</span></span><span style=display:flex><span>bandit12@bandit:/tmp/sequr$ file data8
</span></span><span style=display:flex><span>data8: ASCII text
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>bandit12@bandit:/tmp/sequr$ cat data8
</span></span><span style=display:flex><span>The password is 8Z##########YL
</span></span></code></pre></div><p>Should have automated this somehow …</p><h3 id=level-13---level-14>Level 13 -> Level 14 <a href=#level-13---level-14>¶</a></h3><p>We get a private SSH key for bandit14. So copy this to your local system.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>bandit13@bandit:~$ cat sshkey.private 
</span></span><span style=display:flex><span>-----BEGIN RSA PRIVATE KEY-----
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>...<span style=color:#f92672>]</span>
</span></span></code></pre></div><p>Make sure you set the permissions right (i.e. only the owner should be able to read it), otherwise OpenSSH will refuse to use your key.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>$ chmod <span style=color:#ae81ff>600</span> bandit14_ssh.private
</span></span><span style=display:flex><span>$ ssh -i bandit14_ssh.private bandit14@bandit.labs.overthewire.org -p <span style=color:#ae81ff>2220</span>
</span></span><span style=display:flex><span>bandit14@bandit:~$ cat /etc/bandit_pass/bandit14
</span></span><span style=display:flex><span>4w##########3e
</span></span></code></pre></div><h3 id=level-14---level-15>Level 14 -> Level 15 <a href=#level-14---level-15>¶</a></h3><p>We can use netcat (<code>nc</code>) to openen a network connection to a specific port.</p><p>Once the connection is opened, we enter the required data. The server then responds with the next level&rsquo;s password.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>bandit14@bandit:~$ nc localhost <span style=color:#ae81ff>30000</span>
</span></span><span style=display:flex><span>4w##########3e
</span></span><span style=display:flex><span>Correct!
</span></span><span style=display:flex><span>Bf##########xNr
</span></span></code></pre></div><h3 id=level-15---level-16>Level 15 -> Level 16 <a href=#level-15---level-16>¶</a></h3><p>Since the service on this port uses SSL encryption, we&rsquo;ll need to use a client that&rsquo;s capable of setting up such a connection. OpenSSL provides such a client.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>bandit14@bandit:~$ openssl s_client -connect localhost:30001                                                                                                                                  
</span></span><span style=display:flex><span>CONNECTED<span style=color:#f92672>(</span>00000003<span style=color:#f92672>)</span>                                                                                                                                                                           
</span></span><span style=display:flex><span>depth<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span> CN <span style=color:#f92672>=</span> localhost                                                                                                                                                                        
</span></span><span style=display:flex><span>verify error:num<span style=color:#f92672>=</span>18:self signed certificate                                                                                                                                                   
</span></span><span style=display:flex><span>verify <span style=color:#66d9ef>return</span>:1                                                                                                                                                                               
</span></span><span style=display:flex><span>depth<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span> CN <span style=color:#f92672>=</span> localhost                                                                                                                                                                        
</span></span><span style=display:flex><span>verify <span style=color:#66d9ef>return</span>:1                                                                                                                                                                               
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>...<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>    Extended master secret: yes
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span>Bf##########Nr
</span></span><span style=display:flex><span>Correct!
</span></span><span style=display:flex><span>cl##########hd
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>closed
</span></span></code></pre></div><h3 id=level-16---level-17>Level 16 -> Level 17 <a href=#level-16---level-17>¶</a></h3><p>First get the open ports</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>bandit14@bandit:~$ nmap -v -p 31000-32000 --open localhost
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>...<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>Nmap scan report <span style=color:#66d9ef>for</span> localhost <span style=color:#f92672>(</span>127.0.0.1<span style=color:#f92672>)</span>                                                                                                                                                    
</span></span><span style=display:flex><span>Host is up <span style=color:#f92672>(</span>0.00021s latency<span style=color:#f92672>)</span>.                                                                                                                                                                
</span></span><span style=display:flex><span>Not shown: <span style=color:#ae81ff>999</span> closed ports                                                                                                                                                                   
</span></span><span style=display:flex><span>Some closed ports may be reported as filtered due to --defeat-rst-ratelimit                                                                                                                   
</span></span><span style=display:flex><span>PORT      STATE SERVICE                                                                                                                                                                       
</span></span><span style=display:flex><span>31518/tcp open  unknown                                                                                                                                                                       
</span></span><span style=display:flex><span>31790/tcp open  unknown
</span></span></code></pre></div><p>Then check the services they are running.<br>Note: you could actually immediately add the service scan (<code>-sV</code>) to the first scan.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>bandit14@bandit:~$ nmap -v -sV -p 31518,31790 localhost
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>...<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>Host is up <span style=color:#f92672>(</span>0.00023s latency<span style=color:#f92672>)</span>.                                                                                                                                                                
</span></span><span style=display:flex><span>Not shown: <span style=color:#ae81ff>999</span> closed ports                                                                                                                                                                   
</span></span><span style=display:flex><span>Some closed ports may be reported as filtered due to --defeat-rst-ratelimit                                                                                                                   
</span></span><span style=display:flex><span>PORT      STATE SERVICE     VERSION                                                                                                                                                           
</span></span><span style=display:flex><span>31518/tcp open  ssl/echo                                                                                                                                                                      
</span></span><span style=display:flex><span>31790/tcp open  ssl/unknown                                                                                                                                                                   
</span></span><span style=display:flex><span><span style=color:#ae81ff>1</span> service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :                  
</span></span><span style=display:flex><span>SF-Port31790-TCP:V<span style=color:#f92672>=</span>7.40%T<span style=color:#f92672>=</span>SSL%I<span style=color:#f92672>=</span>7%D<span style=color:#f92672>=</span>1/9%Time<span style=color:#f92672>=</span>5E17044C%P<span style=color:#f92672>=</span>x86_64-pc-linux-gn                                                                                                                    
</span></span><span style=display:flex><span>SF:u%r<span style=color:#f92672>(</span>GenericLines,31,<span style=color:#e6db74>&#34;Wrong!\x20Please\x20enter\x20the\x20correct\x20cur                                                                                                                    
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:rent\x20password\n&#34;</span><span style=color:#f92672>)</span>%r<span style=color:#f92672>(</span>GetRequest,31,<span style=color:#e6db74>&#34;Wrong!\x20Please\x20enter\x20the\
</span></span></span><span style=display:flex><span><span style=color:#e6db74>[...]
</span></span></span></code></pre></div><p>Port 31518 is running the echo service, which basically just returns whatever you send to it (hence: echo).<br>Port 31790 is running a SSL service nmap doesn&rsquo;t recognize (it failed to grab a banner and/or didn&rsquo;t recognize it). In the output you can see the &ldquo;fail&rdquo; strings which are returned if you send it an incorrect password.</p><p>Connect using openssl again. This time we get a SSH private key back.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>bandit14@bandit:~$ openssl s_client -connect localhost:31790                                                                                                                                  
</span></span><span style=display:flex><span>CONNECTED<span style=color:#f92672>(</span>00000003<span style=color:#f92672>)</span>                                                                                                                                                                           
</span></span><span style=display:flex><span>depth<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span> CN <span style=color:#f92672>=</span> localhost
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>...<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>---                                                                                                                                                                                           
</span></span><span style=display:flex><span>cl##########hd                                                                                                                                                              
</span></span><span style=display:flex><span>Correct!                                                                                                                                                                                      
</span></span><span style=display:flex><span>-----BEGIN RSA PRIVATE KEY-----
</span></span><span style=display:flex><span>MIIEogIBAAKCAQEAvmOkuifmMg6HL2YPIOjon6iWfbp7c3jx34YkYWqUH57SUdyJ
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>...<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>vBgsyi/sN3RqRBcGU40fOoZyfAMT8s1m/uYv52O6IgeuZ/ujbjY<span style=color:#f92672>=</span>            
</span></span><span style=display:flex><span>-----END RSA PRIVATE KEY-----                                                                  
</span></span><span style=display:flex><span>                                                                                               
</span></span><span style=display:flex><span>closed
</span></span></code></pre></div><h3 id=level-17---level-18>Level 17 -> Level 18 <a href=#level-17---level-18>¶</a></h3><p>First connect using the private key from the last level.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>$ ssh -i bandit17_ssh.private bandit17@bandit.labs.overthewire.org -p <span style=color:#ae81ff>2220</span>
</span></span></code></pre></div><p>We need to find the line that is _diff_erent between the two files.</p><p>Lines starting with a <code>&lt;</code> are present in FILE1 but not in FILE2.<br>Lines starting with a <code>></code> are present in FILE2 but not in FILE1.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>bandit17@bandit:~$ diff passwords.old passwords.new 
</span></span><span style=display:flex><span>42c42
</span></span><span style=display:flex><span>&lt; hlbSBPAWJmL6WFDb06gpTx1pPButblOA
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span>&gt; kf##########Yd
</span></span></code></pre></div><h3 id=level-18---level-19>Level 18 -> Level 19 <a href=#level-18---level-19>¶</a></h3><p>Notice the note at the previous level:</p><blockquote><p>NOTE: if you have solved this level and see ‘Byebye!’ when trying to log into bandit18, this is related to the next level, bandit19</p><p>~ OverTheWire.org</p></blockquote><p>This is exactly what happens when we try to SSH to the lab as bandit18.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>$ ssh bandit18@bandit.labs.overthewire.org -p <span style=color:#ae81ff>2220</span>                                                                                                                                        
</span></span><span style=display:flex><span>This is a OverTheWire game server. More information on http://www.overthewire.org/wargames
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>...<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>  Enjoy your stay!
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Byebye !
</span></span><span style=display:flex><span>Connection to bandit.labs.overthewire.org closed.
</span></span></code></pre></div><p>The level&rsquo;s description mentions that someone modified the <code>.bashrc</code> file to automatically log us out of a SSH connection.<br><code>.bashrc</code> is a configuration file used by the Bash shell, which is the default shell on many systems.</p><p>Let&rsquo;s ignore <code>.bashrc</code> by not using Bash as our shell. Let&rsquo;s use regular shell instead.<br>Note that we don&rsquo;t get the usual Prompt String (PS1) showing our username and path. However, we are still connected to the system and can execute commands.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>$ ssh bandit18@bandit.labs.overthewire.org -p <span style=color:#ae81ff>2220</span> /bin/sh
</span></span><span style=display:flex><span>This is a OverTheWire game server. More information on http://www.overthewire.org/wargames
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>bandit18@bandit.labs.overthewire.org<span style=color:#960050;background-color:#1e0010>&#39;</span>s password: 
</span></span><span style=display:flex><span>ls <span style=color:#75715e># command</span>
</span></span><span style=display:flex><span>readme <span style=color:#75715e># output</span>
</span></span><span style=display:flex><span>cat readme <span style=color:#75715e># command</span>
</span></span><span style=display:flex><span>Iu##########5x <span style=color:#75715e># output</span>
</span></span></code></pre></div><p>An alternative would&rsquo;ve been not to connect interactively, but use something like SCP (Secure File Copy), which is like FTP (File Transfer Protocol) but over Secure Shell (SSH). However, this level states that you should be able to finish it by only using SSH, ls and cat.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>$ scp -P <span style=color:#ae81ff>2220</span> bandit18@bandit.labs.overthewire.org:readme ./
</span></span><span style=display:flex><span>This is a OverTheWire game server. More information on http://www.overthewire.org/wargames
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>bandit18@bandit.labs.overthewire.org<span style=color:#960050;background-color:#1e0010>&#39;</span>s password: 
</span></span><span style=display:flex><span>readme                    100%   <span style=color:#ae81ff>33</span>     1.2KB/s   00:00
</span></span><span style=display:flex><span>$ cat readme 
</span></span><span style=display:flex><span>Iu##########5x
</span></span></code></pre></div><h3 id=level-19---level-20>Level 19 -> Level 20 <a href=#level-19---level-20>¶</a></h3><p>A setuid binary executes within the context of the user defined by the setuid. As such we can access a file which can only be read by bandit20 as the setuid binary executes under the privileges of that user.</p><p>This binary simply executes the commands passed as parameter, so we simply print the content of the password file.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>bandit19@bandit:~$ ./bandit20-do cat /etc/bandit_pass/bandit20
</span></span><span style=display:flex><span>Gb##########0j
</span></span></code></pre></div></div></article><hr><div class=post-info><p><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7" y2="7"/></svg>
<span class=tag><a href=https://sequr.be/tags/bandit/>Bandit</a></span>
<span class=tag><a href=https://sequr.be/tags/over-the-wire/>Over The Wire</a></span>
<span class=tag><a href=https://sequr.be/tags/overthewire/>OverTheWire</a></span></p><p><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-folder meta-icon"><path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5a2 2 0 012-2h5l2 3h9a2 2 0 012 2z"/></svg>
<span class=tag><a class=p-category href=https://sequr.be/categories/overthewire/>OverTheWire</a></span>
<span class=tag><a class=p-category href=https://sequr.be/categories/writeup/>Writeup</a></span></p><p><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6A2 2 0 004 4v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>
1317 Words</p><p><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
<time class=dt-published datetime=2020-01-09T11:12:17+00:00>2020-01-09
</time>(Last updated: <time class=dt-updated datetime=2020-01-09T11:12:17+00:00>2020-01-09</time>)</p><p><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-user"><path d="M20 21v-2a4 4 0 00-4-4H8a4 4 0 00-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
<span rel=author class="p-author h-card">DezeStijn</span></p></div><hr><div class=sharing-buttons><a class=resp-sharing-button__link href=https://ko-fi.com/s4squatch target=_blank rel=noopener aria-label title="Buy me a coffee"><div class="resp-sharing-button resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentcolor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"><path d="M23.881 8.948c-.773-4.085-4.859-4.593-4.859-4.593H.723c-.604.0-.679.798-.679.798s-.082 7.324-.022 11.822c.164 2.424 2.586 2.672 2.586 2.672s8.267-.023 11.966-.049c2.438-.426 2.683-2.566 2.658-3.734 4.352.24 7.422-2.831 6.649-6.916zm-11.062 3.511c-1.246 1.453-4.011 3.976-4.011 3.976s-.121.119-.31.023c-.076-.057-.108-.09-.108-.09-.443-.441-3.368-3.049-4.034-3.954-.709-.965-1.041-2.7-.091-3.71.951-1.01 3.005-1.086 4.363.407.0.0 1.565-1.782 3.468-.963 1.904.82 1.832 3.011.723 4.311zm6.173.478c-.928.116-1.682.028-1.682.028V7.284h1.77s1.971.551 1.971 2.638c0 1.913-.985 2.667-2.059 3.015z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fsequr.be%2fblog%2f2020%2f01%2fbandit-10-20%2f" target=_blank rel=noopener aria-label title="Share on facebook"><div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 2h-3a5 5 0 00-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 011-1h3z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://twitter.com/intent/tweet/?url=https%3a%2f%2fsequr.be%2fblog%2f2020%2f01%2fbandit-10-20%2f" target=_blank rel=noopener aria-label title="Share on twitter"><div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://reddit.com/submit/?url=https%3a%2f%2fsequr.be%2fblog%2f2020%2f01%2fbandit-10-20%2f&amp;resubmit=true&amp;title=Bandit%20%2810%20-%3e%2020%29" target=_blank rel=noopener aria-label title="Share on reddit"><div class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentcolor" stroke="none"><path d="M12 0A12 12 0 000 12a12 12 0 0012 12 12 12 0 0012-12A12 12 0 0012 0zm5.01 4.744c.688.0 1.25.561 1.25 1.249a1.25 1.25.0 01-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968.0 1.754.786 1.754 1.754.0.716-.435 1.333-1.01 1.614a3.111 3.111.0 01.042.52c0 2.694-3.13 4.87-7.004 4.87s-7.004-2.176-7.004-4.87c0-.183.015-.366.043-.534A1.748 1.748.0 014.028 12c0-.968.786-1.754 1.754-1.754.463.0.898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342.0 01.14-.197.35.35.0 01.238-.042l2.906.617a1.214 1.214.0 011.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687.0 1.248-.561 1.248-1.249S9.937 12 9.249 12zm5.5.0c-.687.0-1.248.561-1.248 1.25.0.687.561 1.248 1.249 1.248S16 13.937 16 13.249c0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327.0 00-.231.094.33.33.0 000 .463c.842.842 2.484.913 2.961.913s2.105-.056 2.961-.913a.361.361.0 00.029-.463.33.33.0 00-.464.0c-.547.533-1.684.73-2.512.73-.828.0-1.979-.196-2.512-.73a.326.326.0 00-.232-.095z"/></svg></div></div></a><a class=resp-sharing-button__link href="mailto:?subject=Bandit%20%2810%20-%3e%2020%29&amp;body=https%3a%2f%2fsequr.be%2fblog%2f2020%2f01%2fbandit-10-20%2f" target=_self rel=noopener aria-label title="Share via email"><div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg></div></div></a></div><div class=pagination><div class=pagination__buttons><span class="button previous"><a href=https://sequr.be/blog/2020/01/bandit-20-30/><span class=button__icon>←</span>
<span class=button__text>Bandit (20 -> 30)</span>
</a></span><span class="button next"><a href=https://sequr.be/blog/2020/01/bandit-0-10/><span class=button__text>Bandit (0 -> 10)</span>
<span class=button__icon>→</span></a></span></div></div></main></div><footer class=footer><div class=footer__inner><div class=footer__content><span>&copy; 2019</span>
<span><a class=h-card rel=me href=https://sequr.be/>DezeStijn</a></span>
<span><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/ target=_blank rel=noopener>CC BY-NC-SA 4.0</a></span>
<span><a href=https://sequr.be/blog/index.xml target=_blank title=rss><svg width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></span></div></div></footer></div><script type=text/javascript src=https://sequr.be/bundle.min.e89fda0f29b95d33f6f4224dd9e5cf69d84aff3818be2b0d73e731689cc374261b016d17d46f8381962fb4a1577ba3017b1f23509d894f6e66431f988c00889e.js integrity="sha512-6J/aDym5XTP29CJN2eXPadhK/zgYvisNc+cxaJzDdCYbAW0X1G+DgZYvtKFXe6MBex8jUJ2JT25mQx+YjACIng=="></script></body></html>